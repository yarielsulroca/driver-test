<div class="exam-list-container">
  <!-- Header con logo y título -->
  <div class="header-section">
    <div class="logo-container">
      <img src="assets/images/Logo_fondo_negro.svg" alt="Logo" class="logo">
    </div>
    <div class="header-content">
      <h1 class="main-title">Exámenes Disponibles</h1>
      <p class="subtitle" *ngIf="conductor">¡Bienvenido, {{ conductor.nombre }} {{ conductor.apellido }}!</p>
      <p class="subtitle" *ngIf="!conductor">Selecciona un examen para comenzar</p>
    </div>
  </div>

  <!-- Barra de acciones -->
  <div class="actions-bar">
    <div class="filters-container">
      <div class="search-container">
        <div class="search-box">
          <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <input 
            type="text" 
            placeholder="Buscar exámenes por categoría..." 
            [(ngModel)]="searchTerm"
            (input)="filterExams()"
            class="search-input"
          >
        </div>
      </div>
      
      <div class="filter-container">
        <select 
          [(ngModel)]="selectedCategory" 
          (change)="filterExams()"
          class="filter-select"
        >
          <option value="">Todas las categorías</option>
                        <option *ngFor="let categoria of categorias" [value]="categoria.categoria_id">
                {{ categoria.codigo }} - {{ categoria.nombre }}
              </option>
        </select>
      </div>
    </div>
    
    <div class="user-info" *ngIf="conductor">
      <div class="user-avatar">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
      </div>
      <div class="user-details">
        <span class="user-name">{{ conductor.nombre }} {{ conductor.apellido }}</span>
        <span class="user-dni">{{ conductor.dni }}</span>
      </div>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="main-content">
    <div class="content-card">
      <!-- Estados de carga y error -->
      <div *ngIf="loading" class="loading-state">
        <div class="spinner"></div>
        <p>Cargando exámenes disponibles...</p>
      </div>

      <div *ngIf="error" class="error-state">
        <svg class="error-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p>{{ error }}</p>
        <button class="btn-secondary" (click)="loadExams()">
          <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
          </svg>
          Reintentar
        </button>
      </div>

      <!-- Estado vacío -->
      <div *ngIf="!loading && filteredExams.length === 0" class="empty-state">
        <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        <h3>No hay exámenes disponibles</h3>
        <p>En este momento no hay exámenes activos para tu categoría</p>
      </div>

      <!-- Lista de exámenes -->
      <div *ngIf="!loading && filteredExams.length > 0" class="exams-section">
        <div class="section-header">
          <h2>Exámenes Habilitados</h2>
          <span class="count-badge">{{ filteredExams.length }} exámenes</span>
        </div>
        
        <div class="exams-grid">
          <div *ngFor="let examen of filteredExams" class="exam-card">
            <div class="exam-header">
              <div class="exam-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
              </div>
              <div class="exam-status" [class]="getExamStatus(examen)">
                {{ getExamStatusText(examen) }}
              </div>
            </div>
            
            <div class="exam-content">
              <h3 class="exam-title">{{ examen.nombre }}</h3>
              <p class="exam-description" *ngIf="examen.descripcion">{{ examen.descripcion }}</p>
              
              <div class="exam-categories" *ngIf="examen.categorias && examen.categorias.length > 0">
                <span class="category-badge" *ngFor="let categoria of examen.categorias">
                  {{ categoria.codigo }} - {{ categoria.nombre }}
                </span>
              </div>
              
              <div class="exam-details">
                <div class="detail-item">
                  <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span>{{ examen.duracion_minutos }} minutos</span>
                </div>
                
                <div class="detail-item">
                  <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span>{{ examen.numero_preguntas }} preguntas</span>
                </div>
                
                <div class="detail-item">
                  <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                  </svg>
                  <span>Mínimo {{ examen.puntaje_minimo }}%</span>
                </div>
              </div>
              
              <div class="exam-dates">
                <div class="date-item">
                  <span class="date-label">Inicio:</span>
                  <span class="date-value">{{ formatDate(examen.fecha_inicio) }}</span>
                </div>
                <div class="date-item">
                  <span class="date-label">Fin:</span>
                  <span class="date-value">{{ formatDate(examen.fecha_fin) }}</span>
                </div>
              </div>
            </div>
            
            <div class="exam-actions">
              <button class="btn-primary" (click)="comenzarExamen(examen)" [disabled]="!canTakeExam(examen)">
                <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                {{ getActionText(examen) }}
              </button>
              
              <button class="btn-secondary" (click)="verDetalles(examen)">
                <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                Ver Detalles
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de detalles del examen -->
<div *ngIf="showDetailsModal" class="modal-overlay" (click)="closeDetailsModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title-section">
        <h2>{{ selectedExam?.nombre }}</h2>
        <p>Detalles del examen</p>
      </div>
      <button class="btn-close" (click)="closeDetailsModal()">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <div class="modal-body" *ngIf="selectedExam">
      <div class="exam-details-modal">
        <div class="detail-section">
          <h3>Información General</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">Descripción:</span>
              <span class="detail-value">{{ selectedExam.descripcion || 'Sin descripción' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Duración:</span>
              <span class="detail-value">{{ selectedExam.duracion_minutos }} minutos</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Preguntas:</span>
              <span class="detail-value">{{ selectedExam.numero_preguntas }} preguntas</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Puntaje mínimo:</span>
              <span class="detail-value">{{ selectedExam.puntaje_minimo }}%</span>
            </div>
          </div>
        </div>

        <div class="detail-section" *ngIf="selectedExam.categorias && selectedExam.categorias.length > 0">
          <h3>Categorías</h3>
          <div class="categories-list">
            <div *ngFor="let categoria of selectedExam.categorias" class="category-item">
              <h4>{{ categoria.codigo }} - {{ categoria.nombre }}</h4>
              <p *ngIf="categoria.descripcion">{{ categoria.descripcion }}</p>
            </div>
          </div>
        </div>

        <div class="detail-section">
          <h3>Fechas</h3>
          <div class="dates-grid">
            <div class="date-item">
              <span class="date-label">Fecha de inicio:</span>
              <span class="date-value">{{ formatDate(selectedExam.fecha_inicio) }}</span>
            </div>
            <div class="date-item">
              <span class="date-label">Fecha de fin:</span>
              <span class="date-value">{{ formatDate(selectedExam.fecha_fin) }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeDetailsModal()">
          Cerrar
        </button>
        <button type="button" class="btn-primary" (click)="comenzarExamen(selectedExam)" [disabled]="!canTakeExam(selectedExam)">
          <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
          {{ getActionText(selectedExam) }}
        </button>
      </div>
    </div>
  </div>
</div>
